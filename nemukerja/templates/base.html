{% set is_admin = current_user.is_authenticated and current_user.role == 'admin' %}
{% set user_role = current_user.role if current_user.is_authenticated else '' %}
<!DOCTYPE html>
{# Tambahkan class="dark" di sini jika mode gelap aktif #}
<html lang="en" class=""> 
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>{% block title %}{% endblock %}</title>

    {# HAPUS LINK BOOTSTRAP CSS #}
    {# <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"> #}
    
    {# Ini adalah style.css Anda yang dihasilkan oleh Tailwind #}
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="tw-bg-gray-50 dark:tw-bg-gray-900 tw-text-gray-900 dark:tw-text-gray-100">

    {# --- NAVBAR VERSI TAILWIND --- #}
    <nav class="tw-fixed tw-top-0 tw-left-0 tw-right-0 tw-bg-white dark:tw-bg-gray-800 tw-shadow-sm tw-z-50 tw-border-b tw-border-gray-200 dark:tw-border-gray-700">
        <div class="tw-container tw-mx-auto tw-px-4 sm:tw-px-6 lg:tw-px-8">
            <div class="tw-flex tw-items-center tw-justify-between tw-h-16">
                
                {# Tombol Toggle Sidebar (Hamburger Icon) - KIRI #}
                <div class="tw-flex tw-items-center">
                    <button id="mobile-menu-toggle" type="button" class="lg:tw-hidden tw-inline-flex tw-items-center tw-justify-center tw-p-2 tw-rounded-md tw-text-gray-400 dark:tw-text-gray-300 hover:tw-text-gray-500 dark:hover:tw-text-white hover:tw-bg-gray-100 dark:hover:tw-bg-gray-700 focus:tw-outline-none focus:tw-ring-2 focus:tw-ring-inset focus:tw-ring-blue-500" aria-controls="mobile-menu" aria-expanded="false">
                        <span class="tw-sr-only">Buka menu utama</span>
                        {# Ikon hamburger #}
                        <svg class="tw-block tw-h-6 tw-w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                        </svg>
                        {# Ikon 'X' (untuk menutup) - bisa di-toggle dengan JS #}
                        <svg class="tw-hidden tw-h-6 tw-w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </button>

                    {# Logo #}
                    <a class="tw-flex-shrink-0 tw-flex tw-items-center tw-gap-2" href="{{ url_for('index') }}">
                        <img src="{{ url_for('static', filename='images/logopeb.png') }}" alt="NemuKerja Logo" width="40" height="40" class="tw-d-inline-block tw-align-top">
                        <span class="tw-font-bold tw-text-blue-600 dark:tw-text-blue-400 tw-text-xl tw-hidden sm:tw-inline brand-text" data-i18n="site_name_id">NemuKerja</span>
                    </a>
                </div>

                {# Menu Desktop (Tengah) #}
                <div class="tw-hidden lg:tw-flex lg:tw-flex-1 lg:tw-items-center lg:tw-justify-center">
                    <ul class="tw-flex tw-space-x-4">
                        <li>
                            <a class="tw-px-3 tw-py-2 tw-rounded-md tw-text-sm tw-font-medium tw-text-gray-700 dark:tw-text-gray-300 hover:tw-bg-gray-100 dark:hover:tw-bg-gray-700" href="{{ url_for('index') }}">
                                <span data-i18n="nav_home_en">Home</span>
                                <span data-i18n="nav_home_id" class="d-none">Beranda</span>
                            </a>
                        </li>
                        
                        {% if is_admin %}
                            <li class="tw-relative" data-controller="dropdown">
                                <button type="button" class="tw-px-3 tw-py-2 tw-rounded-md tw-text-sm tw-font-medium tw-text-gray-700 dark:tw-text-gray-300 hover:tw-bg-gray-100 dark:hover:tw-bg-gray-700 tw-inline-flex tw-items-center" data-action="dropdown#toggle">
                                    <i class="fas fa-tools tw-mr-1"></i>
                                    <span data-i18n="nav_admin_manage_en">Management</span>
                                    <span data-i18n="nav_admin_manage_id" class="d-none">Manajemen</span>
                                    <i class="fas fa-chevron-down tw-ml-2 tw-text-xs"></i>
                                </button>
                                <ul class="tw-absolute tw-z-10 tw-mt-2 tw-w-48 tw-rounded-md tw-shadow-lg tw-py-1 tw-bg-white dark:tw-bg-gray-800 tw-ring-1 tw-ring-black tw-ring-opacity-5 tw-hidden" data-dropdown-target="menu">
                                    <li><a class="tw-block tw-px-4 tw-py-2 tw-text-sm tw-text-gray-700 dark:tw-text-gray-200 hover:tw-bg-gray-100 dark:hover:tw-bg-gray-700" href="{{ url_for('admin_users') }}">
                                        <i class="fas fa-users tw-mr-2 tw-w-4"></i>Manage Users</a></li>
                                    <li><a class="tw-block tw-px-4 tw-py-2 tw-text-sm tw-text-gray-700 dark:tw-text-gray-200 hover:tw-bg-gray-100 dark:hover:tw-bg-gray-700" href="{{ url_for('admin_companies') }}">
                                        <i class="fas fa-building tw-mr-2 tw-w-4"></i>Manage Companies</a></li>
                                    <li><a class="tw-block tw-px-4 tw-py-2 tw-text-sm tw-text-gray-700 dark:tw-text-gray-200 hover:tw-bg-gray-100 dark:hover:tw-bg-gray-700" href="{{ url_for('admin_jobs') }}">
                                        <i class="fas fa-briefcase tw-mr-2 tw-w-4"></i>Manage Jobs</a></li>
                                </ul>
                            </li>
                        {% else %}
                            <li>
                                <a class="tw-px-3 tw-py-2 tw-rounded-md tw-text-sm tw-font-medium tw-text-gray-700 dark:tw-text-gray-300 hover:tw-bg-gray-100 dark:hover:tw-bg-gray-700" href="{{ url_for('dashboard') }}">
                                    <span data-i18n="nav_jobs_en">Job Listing</span>
                                    <span data-i18n="nav_jobs_id" class="d-none">Lowongan</span>
                                </a>
                            </li>
                        {% endif %}

                        <li>
                            <a class="tw-px-3 tw-py-2 tw-rounded-md tw-text-sm tw-font-medium tw-text-gray-700 dark:tw-text-gray-300 hover:tw-bg-gray-100 dark:hover:tw-bg-gray-700" href="{{ url_for('about') }}">
                                <span data-i18n="nav_about_en">About Us</span>
                                <span data-i18n="nav_about_id" class="d-none">Tentang Kami</span>
                            </a>
                        </li>
                        <li>
                            <a class="tw-px-3 tw-py-2 tw-rounded-md tw-text-sm tw-font-medium tw-text-gray-700 dark:tw-text-gray-300 hover:tw-bg-gray-100 dark:hover:tw-bg-gray-700" href="{{ url_for('contact') }}">
                                <span data-i18n="nav_contact_en">Contact</span>
                                <span data-i18n="nav_contact_id" class="d-none">Kontak</span>
                            </a>
                        </li>
                    </ul>
                </div>

                {# Menu Kanan (Auth, Bahasa, Tema) #}
                <div class="tw-hidden lg:tw-flex lg:tw-items-center tw-space-x-3">
                    
                    {# Tombol Bahasa #}
                    <div class="tw-relative" data-controller="dropdown">
                        <button id="langDropdown" type="button" class="lang-dropdown-btn tw-p-2 tw-rounded-full tw-text-gray-500 dark:tw-text-gray-400 hover:tw-bg-gray-100 dark:hover:tw-bg-gray-700" data-action="dropdown#toggle">
                            <i class="fa fa-language tw-text-lg"></i>
                            {# <span id="current-lang" class="tw-ml-1 tw-text-sm">English</span> #}
                        </button>
                        <ul class="tw-absolute tw-z-10 tw-right-0 tw-mt-2 tw-w-40 tw-origin-top-right tw-rounded-md tw-shadow-lg tw-py-1 tw-bg-white dark:tw-bg-gray-800 tw-ring-1 tw-ring-black tw-ring-opacity-5 tw-hidden lang-menu" aria-labelledby="langDropdown" data-dropdown-target="menu">
                            <li><a class="tw-block tw-px-4 tw-py-2 tw-text-sm tw-text-gray-700 dark:tw-text-gray-200 hover:tw-bg-gray-100 dark:hover:tw-bg-gray-700 lang-option" href="#" data-lang="en">English</a></li>
                            <li><a class="tw-block tw-px-4 tw-py-2 tw-text-sm tw-text-gray-700 dark:tw-text-gray-200 hover:tw-bg-gray-100 dark:hover:tw-bg-gray-700 lang-option" href="#" data-lang="id">Bahasa Indonesia</a></li>
                        </ul>
                    </div>

                    {# --- TOMBOL DARK MODE BARU --- #}
                    <button id="theme-toggle" type="button" class="tw-p-2 tw-rounded-full tw-text-gray-500 dark:tw-text-gray-400 hover:tw-bg-gray-100 dark:hover:tw-bg-gray-700">
                        <i class="fas fa-moon tw-hidden dark:tw-inline-block tw-text-lg"></i>
                        <i class="fas fa-sun tw-inline-block dark:tw-hidden tw-text-lg"></i>
                    </button>

                    {% if current_user.is_authenticated %}
                        {# Notifikasi #}
                        <div class="tw-relative" data-controller="dropdown">
                            <button class="tw-p-2 tw-rounded-full tw-text-gray-500 dark:tw-text-gray-400 hover:tw-bg-gray-100 dark:hover:tw-bg-gray-700 tw-relative" type="button" id="notificationDropdown" data-action="dropdown#toggle">
                                <i class="fas fa-bell tw-text-lg"></i>
                                <span class="tw-absolute tw-top-0 tw-right-0 tw-flex tw-h-3 tw-w-3">
                                    <span class="tw-relative tw-inline-flex tw-rounded-full tw-h-3 tw-w-3 tw-bg-red-500" id="notificationBadge" style="display: none;">
                                        <span class="tw-absolute tw-inset-0 tw-animate-ping tw-rounded-full tw-bg-red-400 tw-opacity-75"></span>
                                    </span>
                                </span>
                            </button>
                            <div class="tw-absolute tw-z-10 tw-right-0 tw-mt-2 tw-w-80 sm:tw-w-96 tw-origin-top-right tw-rounded-md tw-shadow-lg tw-bg-white dark:tw-bg-gray-800 tw-ring-1 tw-ring-black tw-ring-opacity-5 tw-hidden" aria-labelledby="notificationDropdown" data-dropdown-target="menu">
                                <div class="tw-p-3 tw-border-b dark:tw-border-gray-700">
                                    <div class="tw-flex tw-justify-between tw-items-center">
                                        <span class="tw-font-medium">
                                            <span data-i18n="notifications_en">Notifications</span>
                                            <span data-i18n="notifications_id" class="d-none">Notifikasi</span>
                                        </span>
                                        <div class="tw-flex tw-space-x-2">
                                            <button class="tw-text-xs tw-text-blue-600 dark:tw-text-blue-400 hover:tw-underline" id="markAllReadBtn">
                                                <span data-i18n="mark_all_read_en">Mark all read</span>
                                                <span data-i18n="mark_all_read_id" class="d-none">Tandai semua</span>
                                            </button>
                                            <button class="tw-text-xs tw-text-red-600 dark:tw-text-red-400 hover:tw-underline" id="clearAllBtn" title="Clear all notifications">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <div id="notificationList" class="tw-max-h-80 tw-overflow-y-auto">
                                    <div class="tw-text-center tw-py-10 tw-text-gray-500">
                                        <span data-i18n="no_notifications_en">No notifications</span>
                                        <span data-i18n="no_notifications_id" class="d-none">Tidak ada notifikasi</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    
                        {# Dropdown Profil #}
                        <div class="tw-relative" data-controller="dropdown">
                            <button class="tw-flex tw-items-center tw-space-x-2 tw-px-3 tw-py-1.5 tw-rounded-md tw-text-sm tw-font-medium tw-text-gray-700 dark:tw-text-gray-200 tw-bg-gray-100 dark:tw-bg-gray-700 hover:tw-bg-gray-200 dark:hover:tw-bg-gray-600" type="button" id="userMenuDropdown" data-action="dropdown#toggle">
                                <i class="fas fa-user-circle tw-text-lg"></i> 
                                <span>{{ current_user.name }}</span>
                                <i class="fas fa-chevron-down tw-ml-1 tw-text-xs"></i>
                            </button>
                            <ul class="tw-absolute tw-z-10 tw-right-0 tw-mt-2 tw-w-56 tw-origin-top-right tw-rounded-md tw-shadow-lg tw-py-1 tw-bg-white dark:tw-bg-gray-800 tw-ring-1 tw-ring-black tw-ring-opacity-5 tw-hidden" aria-labelledby="userMenuDropdown" data-dropdown-target="menu">
                                <li>
                                    <a class="tw-flex tw-items-center tw-px-4 tw-py-2 tw-text-sm tw-text-gray-700 dark:tw-text-gray-200 hover:tw-bg-gray-100 dark:hover:tw-bg-gray-700" href="{{ url_for('dashboard') }}">
                                        <i class="fas fa-tachometer-alt tw-mr-3 tw-w-4"></i> 
                                        <span data-i18n="btn_dashboard_en">Dashboard</span>
                                        <span data-i18n="btn_dashboard_id" class="d-none">Dashboard</span>
                                    </a>
                                </li>
                                {% if user_role == 'applicant' %}
                                    <li>
                                        <a class="tw-flex tw-items-center tw-px-4 tw-py-2 tw-text-sm tw-text-gray-700 dark:tw-text-gray-200 hover:tw-bg-gray-100 dark:hover:tw-bg-gray-700" href="{{ url_for('applicant_profile') }}">
                                            <i class="fas fa-address-card tw-mr-3 tw-w-4"></i> 
                                            <span data-i18n="btn_edit_profile_en">Edit Profile</span>
                                            <span data-i18n="btn_edit_profile_id" class="d-none">Edit Profil</span>
                                        </a>
                                    </li>
                                {% elif user_role == 'company' %}
                                    <li>
                                        <a class="tw-flex tw-items-center tw-px-4 tw-py-2 tw-text-sm tw-text-gray-700 dark:tw-text-gray-200 hover:tw-bg-gray-100 dark:hover:tw-bg-gray-700" href="{{ url_for('view_company_profile') }}"> <i class="fas fa-building tw-mr-3 tw-w-4"></i> 
                                            <span data-i18n="btn_manage_profile_en">Manage Profile</span>
                                            <span data-i18n="btn_manage_profile_id" class="d-none">Kelola Profil</span>
                                        </a>
                                    </li>
                                {% endif %}
                                <li><hr class="tw-border-gray-200 dark:tw-border-gray-700 tw-my-1"></li>
                                <li>
                                    <a class="tw-flex tw-items-center tw-px-4 tw-py-2 tw-text-sm tw-text-red-600 dark:tw-text-red-400 hover:tw-bg-gray-100 dark:hover:tw-bg-gray-700" href="{{ url_for('logout') }}">
                                        <i class="fas fa-sign-out-alt tw-mr-3 tw-w-4"></i> 
                                        <span data-i18n="btn_logout_en">Logout</span>
                                        <span data-i18n="btn_logout_id" class="d-none">Keluar</span>
                                    </a>
                                </li>
                            </ul>
                        </div>
                    
                    {% else %}
                        {# Tombol Login/Register #}
                        <a class="tw-inline-flex tw-items-center tw-px-4 tw-py-2 tw-border tw-border-blue-600 tw-text-sm tw-font-medium tw-rounded-md tw-text-blue-600 dark:tw-text-blue-400 dark:tw-border-blue-400 hover:tw-bg-blue-50 dark:hover:tw-bg-gray-700" href="{{ url_for('login') }}">
                            <span data-i18n="btn_login_en">Login</span>
                            <span data-i18n="btn_login_id" class="d-none">Masuk</span>
                        </a>
                        <a class="tw-inline-flex tw-items-center tw-px-4 tw-py-2 tw-border tw-border-transparent tw-text-sm tw-font-medium tw-rounded-md tw-text-white tw-bg-blue-600 hover:tw-bg-blue-700 dark:tw-bg-blue-500 dark:hover:tw-bg-blue-600" href="{{ url_for('register') }}">
                            <span data-i18n="btn_register_en">Register</span>
                            <span data-i18n="btn_register_id" class="d-none">Daftar</span>
                        </a>
                    {% endif %}
                </div>
            </div>
        </div>

        {# --- MENU MOBILE VERSI TAILWIND --- #}
        {# Kontainer ini akan di-toggle (tw-hidden / tw-block) oleh JS #}
        <div class="lg:tw-hidden tw-hidden" id="mobile-menu">
            <div class="tw-fixed tw-inset-0 tw-z-30 tw-bg-black tw-bg-opacity-50" id="mobile-menu-backdrop"></div>
            
            <div class="tw-fixed tw-inset-y-0 tw-left-0 tw-z-40 tw-w-64 tw-bg-white dark:tw-bg-gray-800 tw-shadow-xl tw-p-4 tw-transform tw--translate-x-full tw-transition-transform tw-duration-300 tw-ease-in-out" id="mobile-menu-panel">
                <div class="tw-flex tw-items-center tw-justify-between tw-mb-4">
                    <h5 class="tw-text-lg tw-font-bold">
                        <span data-i18n="nav_menu_en">Menu</span>
                        <span data-i18n="nav_menu_id" class="d-none">Menu</span>
                    </h5>
                    <button type="button" class="tw-p-2 tw-rounded-md tw-text-gray-400 hover:tw-bg-gray-100 dark:hover:tw-bg-gray-700" id="mobile-menu-close">
                        <i class="fas fa-times tw-text-lg"></i>
                    </button>
                </div>
                
                {# List Menu Mobile #}
                <ul class="tw-flex tw-flex-col tw-space-y-2">
                    <li>
                        <a class="tw-flex tw-items-center tw-px-3 tw-py-2 tw-rounded-md tw-text-base tw-font-medium tw-text-gray-700 dark:tw-text-gray-300 hover:tw-bg-gray-100 dark:hover:tw-bg-gray-700" href="{{ url_for('index') }}">
                            <i class="fas fa-home tw-mr-3 tw-w-5"></i>
                            <span data-i18n="nav_home_en">Home</span>
                            <span data-i18n="nav_home_id" class="d-none">Beranda</span>
                        </a>
                    </li>
                    
                    {% if is_admin %}
                        <li>
                            <a class="tw-flex tw-items-center tw-px-3 tw-py-2 tw-rounded-md tw-text-base tw-font-medium tw-text-gray-700 dark:tw-text-gray-300 hover:tw-bg-gray-100 dark:hover:tw-bg-gray-700" href="{{ url_for('admin_dashboard') }}">
                                <i class="fas fa-tachometer-alt tw-mr-3 tw-w-5"></i>
                                Admin Dashboard
                            </a>
                        </li>
                        {# Dropdown Admin Mobile (bisa pakai <details>) #}
                        <li>
                            <details class="tw-group">
                                <summary class="tw-flex tw-items-center tw-justify-between tw-px-3 tw-py-2 tw-rounded-md tw-text-base tw-font-medium tw-text-gray-700 dark:tw-text-gray-300 hover:tw-bg-gray-100 dark:hover:tw-bg-gray-700 tw-cursor-pointer">
                                    <span class="tw-flex tw-items-center">
                                        <i class="fas fa-tools tw-mr-3 tw-w-5"></i>
                                        <span data-i18n="nav_admin_manage_en">Management</span>
                                        <span data-i18n="nav_admin_manage_id" class="d-none">Manajemen</span>
                                    </span>
                                    <i class="fas fa-chevron-down group-open:tw-rotate-180 tw-transition-transform tw-duration-200"></i>
                                </summary>
                                <ul class="tw-pl-8 tw-mt-1 tw-space-y-1">
                                    <li><a class="tw-flex tw-items-center tw-px-3 tw-py-1.5 tw-rounded-md tw-text-sm tw-text-gray-600 dark:tw-text-gray-400 hover:tw-bg-gray-100 dark:hover:tw-bg-gray-700" href="{{ url_for('admin_users') }}"><i class="fas fa-users tw-mr-2 tw-w-4"></i>Manage Users</a></li>
                                    <li><a class="tw-flex tw-items-center tw-px-3 tw-py-1.5 tw-rounded-md tw-text-sm tw-text-gray-600 dark:tw-text-gray-400 hover:tw-bg-gray-100 dark:hover:tw-bg-gray-700" href="{{ url_for('admin_companies') }}"><i class="fas fa-building tw-mr-2 tw-w-4"></i>Manage Companies</a></li>
                                    <li><a class="tw-flex tw-items-center tw-px-3 tw-py-1.5 tw-rounded-md tw-text-sm tw-text-gray-600 dark:tw-text-gray-400 hover:tw-bg-gray-100 dark:hover:tw-bg-gray-700" href="{{ url_for('admin_jobs') }}"><i class="fas fa-briefcase tw-mr-2 tw-w-4"></i>Manage Jobs</a></li>
                                </ul>
                            </details>
                        </li>
                    {% else %}
                        <li>
                            <a class="tw-flex tw-items-center tw-px-3 tw-py-2 tw-rounded-md tw-text-base tw-font-medium tw-text-gray-700 dark:tw-text-gray-300 hover:tw-bg-gray-100 dark:hover:tw-bg-gray-700" href="{{ url_for('dashboard') }}">
                                <i class="fas fa-list-alt tw-mr-3 tw-w-5"></i>
                                <span data-i18n="nav_jobs_en">Job Listing</span>
                                <span data-i18n="nav_jobs_id" class="d-none">Lowongan</span>
                            </a>
                        </li>
                    {% endif %}

                    <li>
                        <a class="tw-flex tw-items-center tw-px-3 tw-py-2 tw-rounded-md tw-text-base tw-font-medium tw-text-gray-700 dark:tw-text-gray-300 hover:tw-bg-gray-100 dark:hover:tw-bg-gray-700" href="{{ url_for('about') }}">
                            <i class="fas fa-info-circle tw-mr-3 tw-w-5"></i>
                            <span data-i18n="nav_about_en">About Us</span>
                            <span data-i18n="nav_about_id" class="d-none">Tentang Kami</span>
                        </a>
                    </li>
                    <li>
                        <a class="tw-flex tw-items-center tw-px-3 tw-py-2 tw-rounded-md tw-text-base tw-font-medium tw-text-gray-700 dark:tw-text-gray-300 hover:tw-bg-gray-100 dark:hover:tw-bg-gray-700" href="{{ url_for('contact') }}">
                            <i class="fas fa-envelope tw-mr-3 tw-w-5"></i>
                            <span data-i18n="nav_contact_en">Contact</span>
                            <span data-i18n="nav_contact_id" class="d-none">Kontak</span>
                        </a>
                    </li>
                </ul>

                <hr class="tw-my-4 tw-border-gray-200 dark:tw-border-gray-700">

                <ul class="tw-flex tw-flex-col tw-space-y-3">
                    {# Auth, Bahasa, dll. untuk Mobile #}
                    {% if current_user.is_authenticated %}
                        {% if user_role == 'applicant' %}
                            <li>
                                <a class="tw-flex tw-items-center tw-justify-center tw-w-full tw-px-4 tw-py-2 tw-border tw-border-gray-300 dark:tw-border-gray-600 tw-text-sm tw-font-medium tw-rounded-md tw-text-gray-700 dark:tw-text-gray-200 tw-bg-white dark:tw-bg-gray-700 hover:tw-bg-gray-50 dark:hover:tw-bg-gray-600" href="{{ url_for('applicant_profile') }}">
                                    <i class="fas fa-address-card tw-mr-2"></i> 
                                    <span data-i18n="btn_edit_profile_en">Edit Profile</span>
                                    <span data-i18n="btn_edit_profile_id" class="d-none">Edit Profil</span>
                                </a>
                            </li>
                        {% elif user_role == 'company' %}
                             <li>
                                <a class="tw-flex tw-items-center tw-justify-center tw-w-full tw-px-4 tw-py-2 tw-border tw-border-gray-300 dark:tw-border-gray-600 tw-text-sm tw-font-medium tw-rounded-md tw-text-gray-700 dark:tw-text-gray-200 tw-bg-white dark:tw-bg-gray-700 hover:tw-bg-gray-50 dark:hover:tw-bg-gray-600" href="{{ url_for('view_company_profile') }}">
                                    <i class="fas fa-building tw-mr-2"></i> 
                                    <span data-i18n="btn_manage_profile_en">Manage Profile</span>
                                    <span data-i18n="btn_manage_profile_id" class="d-none">Kelola Profil</span>
                                </a>
                            </li>
                        {% endif %}
                        <li>
                            <a class="tw-flex tw-items-center tw-justify-center tw-w-full tw-px-4 tw-py-2 tw-border tw-border-transparent tw-text-sm tw-font-medium tw-rounded-md tw-text-white tw-bg-red-600 hover:tw-bg-red-700 dark:tw-bg-red-500 dark:hover:tw-bg-red-600" href="{{ url_for('logout') }}">
                                <i class="fas fa-sign-out-alt tw-mr-2"></i>
                                <span data-i18n="btn_logout_en">Logout</span>
                                <span data-i18n="btn_logout_id" class="d-none">Keluar</span>
                            </a>
                        </li>
                    {% else %}
                        <li>
                            <a class="tw-flex tw-items-center tw-justify-center tw-w-full tw-px-4 tw-py-2 tw-border tw-border-blue-600 tw-text-sm tw-font-medium tw-rounded-md tw-text-blue-600 dark:tw-text-blue-400 dark:tw-border-blue-400 hover:tw-bg-blue-50 dark:hover:tw-bg-gray-700" href="{{ url_for('login') }}">
                                <span data-i18n="btn_login_en">Login</span>
                                <span data-i18n="btn_login_id" class="d-none">Masuk</span>
                            </a>
                        </li>
                        <li>
                            <a class="tw-flex tw-items-center tw-justify-center tw-w-full tw-px-4 tw-py-2 tw-border tw-border-transparent tw-text-sm tw-font-medium tw-rounded-md tw-text-white tw-bg-blue-600 hover:tw-bg-blue-700 dark:tw-bg-blue-500 dark:hover:tw-bg-blue-600" href="{{ url_for('register') }}">
                                <span data-i18n="btn_register_en">Register</span>
                                <span data-i18n="btn_register_id" class="d-none">Daftar</span>
                            </a>
                        </li>
                    {% endif %}
                </ul>
            </div>
        </div>
    </nav>

    {# --- FLASH MESSAGES VERSI TAILWIND --- #}
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            <div id="flash-messages-container" aria-live="polite" aria-atomic="true" class="tw-fixed tw-top-20 tw-right-0 tw-z-[100] tw-w-full tw-max-w-md tw-p-4 sm:tw-p-6">
                {% for category, message in messages %}
                    {% set color = 'blue' %}
                    {% if category == 'error' %}
                        {% set color = 'red' %}
                    {% elif category == 'success' %}
                        {% set color = 'green' %}
                    {% endif %}
                    <div class_name="flash-message tw-relative tw-p-4 tw-mb-4 tw-rounded-lg tw-shadow-lg tw-bg-white dark:tw-bg-gray-800 tw-border-l-4 tw-border-{{ color }}-500 dark:tw-border-{{ color }}-400" role="alert">
                        <div class="tw-flex tw-items-start">
                            <div class="tw-ml-3 tw-flex-1">
                                <p class="tw-text-sm tw-font-medium tw-text-{{ color }}-800 dark:tw-text-{{ color }}-200">
                                    {{ message }}
                                </p>
                            </div>
                            <button type="button" class="tw-ml-4 tw-p-1.5 tw-rounded-md tw-text-{{ color }}-500 dark:tw-text-{{ color }}-400 hover:tw-bg-{{ color }}-100 dark:hover:tw-bg-gray-700 focus:tw-outline-none focus:tw-ring-2 focus:tw-ring-{{ color }}-500" onclick="this.parentElement.parentElement.remove()">
                                <span class="tw-sr-only">Tutup</span>
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    </div>
                {% endfor %}
            </div>
        {% endif %}
    {% endwith %}

    {# Konten utama, beri padding atas untuk navbar #}
    <main class="tw-pt-16 tw-min-h-screen">
        {% block content %}{% endblock %}
    </main>

    {# --- MODAL VERSI TAILWIND --- #}
    {# 
        PERHATIAN: Modal ini TIDAK AKAN berfungsi tanpa JS kustom. 
        Anda harus menggunakan script.js Anda untuk menambahkan/menghapus class 'tw-hidden' 
        pada 'jobDetailModal' dan 'jobDetailModalBackdrop' untuk menampilkannya. 
    #}
    <div id="jobDetailModal" class="tw-fixed tw-inset-0 tw-z-[1050] tw-flex tw-items-center tw-justify-center tw-p-4 tw-hidden">
        {# Backdrop #}
        <div id="jobDetailModalBackdrop" class="tw-fixed tw-inset-0 tw-bg-black tw-bg-opacity-50 tw-transition-opacity"></div>
        
        {# Konten Modal #}
        <div class="tw-relative tw-w-full tw-max-w-3xl tw-bg-white dark:tw-bg-gray-800 tw-rounded-lg tw-shadow-xl tw-flex tw-flex-col tw-max-h-[90vh]">
            <div class="tw-flex tw-items-start tw-justify-between tw-p-4 tw-border-b tw-rounded-t dark:tw-border-gray-700">
                <h5 class="tw-text-xl tw-font-semibold" id="jobDetailTitle">
                    <span data-i18n="index_job_details_en">Job Details</span>
                    <span data-i18n="index_job_details_id" class="d-none">Detail Pekerjaan</span>
                </h5>
                {# Tombol Close (perlu JS) #}
                <button type="button" class="tw-text-gray-400 tw-bg-transparent hover:tw-bg-gray-200 dark:hover:tw-bg-gray-600 hover:tw-text-gray-900 dark:hover:tw-text-white tw-rounded-lg tw-text-sm tw-p-1.5 tw-ml-auto tw-inline-flex tw-items-center" data-action-close-modal="jobDetailModal">
                    <i class="fas fa-times tw-w-5 tw-h-5"></i>
                    <span class="tw-sr-only">Tutup modal</span>
                </button>
            </div>
            
            <div class="tw-p-6 tw-overflow-y-auto" id="jobDetailBody">
                {# Konten modal akan dimuat di sini oleh JS Anda #}
            </div>
            
            <div class="tw-flex tw-items-center tw-justify-end tw-p-4 tw-space-x-2 tw-border-t tw-border-gray-200 dark:tw-border-gray-700 tw-rounded-b">
                <span id="applyButtonContainer"></span>
                <button type="button" class="tw-px-4 tw-py-2 tw-text-sm tw-font-medium tw-text-gray-700 dark:tw-text-gray-300 tw-bg-white dark:tw-bg-gray-700 tw-border tw-border-gray-300 dark:tw-border-gray-600 tw-rounded-lg hover:tw-bg-gray-100 dark:hover:tw-bg-gray-600 focus:tw-ring-4 focus:tw-ring-blue-300" data-action-close-modal="jobDetailModal">
                    <span data-i18n="btn_close_en">Close</span>
                    <span data-i18n="btn_close_id" class="d-none">Tutup</span>
                </button>
            </div>
        </div>
    </div>


    {# HAPUS SCRIPT BOOTSTRAP #}
    {# <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script> #}
    
    {# Script Anda yang sudah ada #}
    <script src="{{ url_for('static', filename='script.js') }}"></script>

    <script>
        window.isAuthenticated = {{ current_user.is_authenticated|tojson|safe }};
        window.currentUserRole = "{{ current_user.role if current_user.is_authenticated else '' }}";

        {# --- SCRIPT BARU UNTUK DARK MODE & MENU TOGGLE --- #}
        
        (function() {
            // --- Dark Mode Toggle ---
            const themeToggle = document.getElementById('theme-toggle');
            const htmlElement = document.documentElement;

            // Cek tema tersimpan saat memuat halaman
            if (localStorage.getItem('theme') === 'dark' || 
               (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
                htmlElement.classList.add('dark');
            } else {
                htmlElement.classList.remove('dark');
            }

            themeToggle.addEventListener('click', () => {
                if (htmlElement.classList.contains('dark')) {
                    htmlElement.classList.remove('dark');
                    localStorage.setItem('theme', 'light');
                } else {
                    htmlElement.classList.add('dark');
                    localStorage.setItem('theme', 'dark');
                }
            });

            // --- Mobile Menu Toggle ---
            // Ini adalah contoh dasar. Anda HARUS memindahkannya ke script.js 
            // dan membuatnya lebih baik (misal, menangani ikon hamburger/X).
            const menuToggle = document.getElementById('mobile-menu-toggle');
            const menuClose = document.getElementById('mobile-menu-close');
            const mobileMenu = document.getElementById('mobile-menu');
            const mobileMenuPanel = document.getElementById('mobile-menu-panel');

            function openMenu() {
                mobileMenu.classList.remove('tw-hidden');
                // Beri sedikit waktu untuk transisi
                setTimeout(() => {
                    mobileMenuPanel.classList.remove('tw--translate-x-full');
                }, 10);
            }

            function closeMenu() {
                mobileMenuPanel.classList.add('tw--translate-x-full');
                setTimeout(() => {
                    mobileMenu.classList.add('tw-hidden');
                }, 300); // Sesuaikan dengan durasi transisi Anda
            }

            if (menuToggle && mobileMenu && menuClose && mobileMenuPanel) {
                menuToggle.addEventListener('click', openMenu);
                menuClose.addEventListener('click', closeMenu);
                document.getElementById('mobile-menu-backdrop').addEventListener('click', closeMenu);
            }

            // --- Dropdown Toggle (Contoh Sederhana) ---
            // Anda HARUS mengganti ini dengan logika di script.js Anda
            // Ini menggunakan data-controller="dropdown" seperti di HTML
            document.querySelectorAll('[data-controller="dropdown"]').forEach(controller => {
                const toggle = controller.querySelector('[data-action="dropdown#toggle"]');
                const menu = controller.querySelector('[data-dropdown-target="menu"]');
                
                if (toggle && menu) {
                    toggle.addEventListener('click', (e) => {
                        e.stopPropagation();
                        menu.classList.toggle('tw-hidden');
                    });
                }
            });
            
            // Tutup dropdown jika klik di luar
            document.addEventListener('click', (e) => {
                document.querySelectorAll('[data-dropdown-target="menu"]').forEach(menu => {
                    if (!menu.parentElement.contains(e.target)) {
                        menu.classList.add('tw-hidden');
                    }
                });
            });


            // --- Modal Toggle (Contoh Sederhana) ---
            // Anda HARUS mengintegrasikan ini dengan logika Anda yang ada
            const modal = document.getElementById('jobDetailModal');
            if(modal) {
                // Tombol untuk menutup modal
                modal.querySelectorAll('[data-action-close-modal]').forEach(button => {
                    button.addEventListener('click', () => {
                        modal.classList.add('tw-hidden');
                    });
                });
                
                // Menutup jika klik backdrop
                const backdrop = document.getElementById('jobDetailModalBackdrop');
                if (backdrop) {
                    backdrop.addEventListener('click', () => {
                        modal.classList.add('tw-hidden');
                    });
                }
            }
            // Anda masih perlu JS untuk MEMBUKA modal (misal, saat klik 'Details')
            // Contoh: document.getElementById('tombol-detail-job').addEventListener('click', () => {
            //    document.getElementById('jobDetailModal').classList.remove('tw-hidden');
            // });

        })();
    </script>
</body>
</html>